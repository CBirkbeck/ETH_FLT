<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>ETH_FLT</title>

		<meta name="description" content="Algebra and Number Theory in Lean">
		<meta name="author" content="Chris Birkbeck">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
		<style>
		pre code {
		    font-size: 0.7em; /* Change 80% to whatever width you prefer */
		}
		</style>
		 <script type="module">
			import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@9/dist/mermaid.esm.min.mjs';
			mermaid.initialize({
				startOnLoad: true,
				theme: 'base',
				themeVariables: {
					primaryColor: 'rgba(255, 255, 255, 0.050)',
					primaryTextColor: '#fff',
					primaryBorderColor: 'rgba(255, 255, 255, 0.18)',
					boxShadow: '0 8px 12px rgba(0,0,0,0.1)',
					nodeBorderRadius: '15px',
					padding: '20px',
					margin: '10px',
					minWidth: '400px',
					backdropFilter: 'blur(20px)',
					webkitBackdropFilter: 'blur(20px)',
					fontWeight: 'bold',
					textAlign: 'center',
					lineHeight: '2'
				}
			});
		</script>
		<style>
		.reveal .slides {
		    width: 100%; /* Adjust this value as needed */
		    height: auto; /* Keeps the height adaptable */
		}
		</style>
		<style>
		/* Custom CSS for theorem and definition */
		.reveal .theorem, .reveal .definition {
			margin: 2em 0;
			padding: 1em 1em;
			border-left: 5px solid #3498db;
			border-right: 5px solid #3498db;
			background-color: #2c3e50; /* Dark grey background */
			
		}
		
		
		.reveal .theorem p:first-child, .reveal .definition p:first-child {
			margin-top: 0;
		}
		
		.reveal .theorem p:last-child, .reveal .definition p:last-child {
			margin-bottom: 0;
		}
		</style>
		<script>
			document.addEventListener("DOMContentLoaded", event => {
			  // we can move only if we are not in a browser's tab
			  isBrowser = matchMedia("(display-mode: browser)").matches;
			  if (!isBrowser) {
				  window.resizeTo(1024, 768);
			  }
			});
		  </script>
		<style>
		.bento-box {
		  display: flex;
		  justify-content: space-around;
		  flex-wrap: wrap;
		  margin-top: 20px;
		}
		
		.bento-box .box {
		  flex: 1;
		  margin: 10px;
		  padding: 20px;
		  background-color:#2c3e50; /* Light grey background */
		  border-radius: 15px; /* Rounded corners */
		  box-shadow: 0 4px 6px rgba(0,0,0,0.1); /* Soft shadow */
		  min-width: 250px; /* Minimum width of boxes */
		  text-align: center; /* Center text */
		}  

		.box .inner-box {
			background-color: #e0e0e0; /* Slightly different background to distinguish */
			margin-bottom: 10px; /* Space between the two inner boxes */
			padding: 10px;
			border-radius: 10px; /* Optional: rounded corners for inner boxes */
			}

			/* Last inner-box should not have a margin at the bottom */
			.box .inner-box:last-child {
			margin-bottom: 0;
			}
		</style>
	</head>

	<body>

		<div class="reveal" >

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<h2>
						<span style="text-transform: none;">The regular case of Fermat's Last Theorem in</span>
						<span style="text-transform: none; color: #000000">Lean</span>
					</h2>
					<p>
						<small>Chris Birkbeck</small>
					</p>
					<p>
						<small>University of East Anglia</small>
					</p>
					<small>
						slides: <a style="color: #000000;" href="https://cbirkbeck.github.io/ETH_FLT/">
						cbirkbeck.github.io/ETH_FLT/</a>
					</small>
					<div style="text-align: center;">
						<img src="QR.png" alt="QR Code" style="width: 100px; height: 100px;">
					</div>
					<small style="display: block; text-align: center; opacity: 0.5">2024-10-18</small>
				</section>
			

				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">What is Lean?</span>
						---
						### <span style="text-transform: none;">What is Lean?</span>
						- Lean is a specialised computer language for <span style="text-transform: none; color: #000000">digitising</span> and <span style="text-transform: none; color: #000000">verifying</span> mathematics.
						---
						### <span style="text-transform: none;">What is Lean?</span>
						- Lean is a specialised computer language for <span style="text-transform: none; color: #000000">digitising</span> and <span style="text-transform: none; color: #000000">verifying</span> mathematics.
						- Using Lean we are creating a digital library of mathematics called <span style="text-transform: none; color: #000000">mathlib</span> (some call it a digital Bourbaki).
						---
						### <span style="text-transform: none;">Why do this?</span>
						---
						### <span style="text-transform: none;">Why do this?</span>
						- Its fun!
						---
						### <span style="text-transform: none;">Why do this?</span>
						- Its fun!
						- It's nice to be able to verify proofs.
						---
						### <span style="text-transform: none;">Why do this?</span>
						- Its fun!
						- It's nice to be able to verify proofs.
						- We are seeing interesting developments in the field, such as <span style="text-transform: none; color: #000000">AlphaProof</span> "winning" a silver medal at this year's IMO.
						---
						### <span style="text-transform: none;">Why do this?</span>
						- Its fun!
						- It's nice to be able to verify proofs.
						- We are seeing interesting developments in the field, such as <span style="text-transform: none; color: #000000">AlphaProof</span>  "winning" a silver medal at this year's IMO.
						- Growing interest from mathematicians. For example, <span style="text-transform: none; color: #000000"> Scholze</span> and  <span style="text-transform: none; color: #000000">Tao</span>.
						---
						### <span style="text-transform: none;">Current state of Lean/mathlib</span>
						- Still lots of maths needs to be formalised before we can begin formalising current reseach in most (not all!) areas.
						---
						### <span style="text-transform: none;">Current state of Lean/mathlib</span>
						- Still lots of maths needs to be formalised before we can begin formalising current reseach in most (not all!) areas.
						- Its non-trivial to turn known maths into Lean code (we'll see some examples of this today).
						---
						### <span style="text-transform: none;">Current state of Lean/mathlib</span>
						- Still lots of maths needs to be formalised before we can begin formalising current reseach in most (not all!) areas.
						- Its non-trivial to turn known maths into Lean code (we'll see some examples of this today).
						- While LLMs are getting better, they are still far from being able to do anything really new.
						---
						### Today 
						- I'll discuss some work formalising the <span style="text-transform: none; color: #000000"> regular case</span>  of Fermat's Last Theorem in Lean.
						---
						### Today 
						- I'll discuss some work formalising the <span style="text-transform: none; color: #000000"> regular case</span>  of Fermat's Last Theorem in Lean.
						- I'll try to highlight the difficulties that we encountered and some solutions to them.
						---
						### Today 
						- I'll discuss some work formalising the <span style="text-transform: none; color: #000000"> regular case</span>  of Fermat's Last Theorem in Lean.
						- I'll try to highlight the difficulties that we encountered and some solutions to them.
						- This is all joint work with <span style="text-transform: none; color: #000000"> A.J. Best, R. Brasca, E. Rodriguez, R. Van de Velde</span>  and <span style="text-transform: none; color: #000000">A. Yang</span> 
						---
						### <span style="text-transform: none;">Fermat's Last Theorem</span> 
						<div class="definition">
							<strong>Theorem</strong>: 
							Let $x,y,z,n \in \mathbb{N}$ and $n \geq 3$. Then $$x^n + y^n = z^n$$ has no solutions with $xyz \neq 0$. 
							</div>
						---
						### <span style="text-transform: none;">The regular case </span>
						<div class="definition">
							<strong>Definition</strong>: 
							A prime $p$ is regular if $p$ does not divide the class number of $\mathbb{Q}(\zeta_p)$.
							</div>		
						---
						### <span style="text-transform: none;">The regular case </span>
						- If we take the exponent $n=p$  **a regular prime** we call this the regular case (first irregular prime is 37).
						---
						### <span style="text-transform: none;">The regular case </span>
						- If we take the exponent $n=p$  **a regular prime** we call this the regular case (first irregular prime is 37).
						- Proof in this case is much easier than the general case and was known to <span style="text-transform: none; color: #000000">Kummer</span>.
						---
						### <span style="text-transform: none;">The regular case </span>
						- If we take the exponent $n=p$  **a regular prime** we call this the regular case (first irregular prime is 37).
						- Proof in this case is much easier than the general case and was known to <span style="text-transform: none; color: #000000">Kummer</span>.
						- I'll first show you the formalised statement in Lean and then remind you how the proof goes.  

						
					
					</textarea>
				</section>
				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<h4>Fermat's Last Theorem in Lean </h4>
					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-3|5-6|8-10">
						/-- Statement of Fermat's Last Theorem over a given semiring with a specific exponent. -/
						def FermatLastTheoremWith (α : Type*) [Semiring α] (n : ℕ) : Prop :=
						∀ a b c : α, a ≠ 0 → b ≠ 0 → c ≠ 0 → a ^ n + b ^ n ≠ c ^ n

						/-- Statement of Fermat's Last Theorem over the naturals for a given exponent. -/
						def FermatLastTheoremFor (n : ℕ) : Prop := FermatLastTheoremWith ℕ n

						/-- Statement of Fermat's Last Theorem: `a ^ n + b ^ n = c ^ n` has no nontrivial natural solution
						when `n ≥ 3`. -/
						def FermatLastTheorem : Prop := ∀ n ≥ 3, FermatLastTheoremFor n
					</code></pre>
				</section>
				
				
				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<h4>Cyclotomic fields </h4>
					<p>Before even stating what a regular prime is we needed to define cyclotomic fields!</p>
			


					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" >
						/-- Given `n : ℕ+` and a field `K`, we define `CyclotomicField n K` as the
							splitting field of `cyclotomic n K`. If `n` is nonzero in `K`, it has
							the instance `IsCyclotomicExtension {n} K (CyclotomicField n K)`. -/
							def CyclotomicField : Type w :=
								(cyclotomic n K).SplittingField
					</code></pre>
		
				</section>

				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<h4>Cyclotomic fields </h4>
					<p>More generally</p>
			


					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1|2-4|5-6">
						variable [CommRing A] [CommRing B] [Algebra A B] (S : Set ℕ+)				
						class IsCyclotomicExtension : Prop where
						/-- For all `n ∈ S`, there exists a primitive `n`-th root of unity in `B`. -/
						exists_prim_root {n : ℕ+} (ha : n ∈ S) : ∃ r : B, IsPrimitiveRoot r n
						/-- The `n`-th roots of unity, for `n ∈ S`, generate `B` as an `A`-algebra. -/
						adjoin_roots : ∀ x : B, x ∈ adjoin A {b : B | ∃ n : ℕ+, n ∈ S ∧ b ^ (n : ℕ) = 1}
					</code></pre>
		
				</section>
				
				
				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" >
						variable [CommRing A] [CommRing B] [Algebra A B] (S : Set ℕ+)				
						class IsCyclotomicExtension : Prop where
						/-- For all `n ∈ S`, there exists a primitive `n`-th root of unity in `B`. -/
						exists_prim_root {n : ℕ+} (ha : n ∈ S) : ∃ r : B, IsPrimitiveRoot r n
						/-- The `n`-th roots of unity, for `n ∈ S`, generate `B` as an `A`-algebra. -/
						adjoin_roots : ∀ x : B, x ∈ adjoin A {b : B | ∃ n : ℕ+, n ∈ S ∧ b ^ (n : ℕ) = 1}
					</code></pre>
					<ul>
						<li>Using this class is like proving things for abstract cyclotomic extensions, not a fixed choice of 'model'.</li>
						<li>Enables nice automation.</li>
					</ul>
				</section>

				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" >
						variable [CommRing A] [CommRing B] [Algebra A B] (S : Set ℕ+)				
						class IsCyclotomicExtension : Prop where
						/-- For all `n ∈ S`, there exists a primitive `n`-th root of unity in `B`. -/
						exists_prim_root {n : ℕ+} (ha : n ∈ S) : ∃ r : B, IsPrimitiveRoot r n
						/-- The `n`-th roots of unity, for `n ∈ S`, generate `B` as an `A`-algebra. -/
						adjoin_roots : ∀ x : B, x ∈ adjoin A {b : B | ∃ n : ℕ+, n ∈ S ∧ b ^ (n : ℕ) = 1}
					</code></pre>
					<ul>
						<li>We chose to work with <span style="text-transform: none; color: #000000">positive</span>  natural numbers since we didn't want to have to exclude the $0$-th cyclitomic extention all over the place.</li>
						<li>This was at the cost of later having lots of extra coercions.</li>
					</ul>
				</section>
				
				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<h4>Regular FLT </h4>
					<p>With this we can then state our main result!</p>
			


					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-3|5-7|9-11|12-19">
						/-- A natural number `n` is regular if `n` is coprime with the cardinal of the class group -/
						def IsRegularNumber [hn : Fact (0 < n)] : Prop :=
							n.Coprime <| Fintype.card <| ClassGroup (𝓞 <| CyclotomicField ⟨n, hn.out⟩ ℚ)

						/-- The definition of regular primes. -/
						def IsRegularPrime (p : ℕ) [hp : Fact p.Prime] : Prop :=
							IsRegularNumber p

						/-- Fermat's last theorem for regular primes. -/
						theorem flt_regular {p : ℕ} [Fact p.Prime] (hreg : IsRegularPrime p) (hodd : p ≠ 2) :
							FermatLastTheoremFor p := by
						apply fermatLastTheoremFor_iff_int.mpr -- suffices to prove the integer version
						intro a b c ha hb hc e
						have hprod := mul_ne_zero (mul_ne_zero ha hb) hc
						obtain ⟨e', hgcd, hprod'⟩ := MayAssume.coprime e hprod
						let d := ({a, b, c} : Finset ℤ).gcd id
						by_cases case : ↑p ∣ (a / d) * (b / d) * (c / d)
						exact caseII hreg hodd hprod' hgcd case e'
						exact caseI hreg case e' case
					</code></pre>
		
				</section>
				
				
				
				
				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">FLT for regular primes </span>
						The proof splits into two cases:
						<div class="definition">
							<strong>Case I</strong>: 
							Let $p \neq 2$ be a regular prime. Then $$x^p+y^p=z^p$$ has no solutions with $x,y,z \in \Z$ and $\gcd(xyz,p)=1$.
							</div>
						---
						### <span style="text-transform: none;">FLT for regular primes </span>
						<div class="definition">
							<strong>Case II</strong>: 
							Let $p \neq 2$ be a regular prime. Then there are no solutions to $x^p+y^p=z^p$ with 
							<ul>
								<li>$xyz \neq 0$.</li>
								<li>$\gcd(x, y, z) = 1$.</li>
								<li>$p \mid xyz$.</li>
							</ul>
							</div>
						---
						### <span style="text-transform: none;">Case I </span> 
						**Proof Idea**: 
						- Factor in $\mathbb{Q}(\zeta_p)$ to get $$x^p+y^p=\prod_{i=0}^{p-1} (x+\zeta_p^i y)$$
						---
						### <span style="text-transform: none;">Case I </span> 
						**Proof Idea**: 
						- Factor in $\mathbb{Q}(\zeta_p)$ to get $$x^p+y^p=\prod_{i=0}^{p-1} (x+\zeta_p^i y)$$
						- Turn this into a question about ideals in $\mathbb{Z}[\zeta_p]$ (which we had to check was the ring of integers of $\mathbb{Q}(\zeta_p)$)
						---
						### <span style="text-transform: none;">Case I </span> 
						**Proof Idea**:
						- Deal with lots of lemmas about units and ideals.
						- Use the class number condition to get a contradiction.
					</textarea>	
				</section>	

				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">This required: </span> 
						- Definitions of <span style="text-transform: none; color: #000000"> cyclotomic fields</span>   and  <span style="text-transform: none; color: #000000"> cyclotomic extensions</span>.
						---
						### <span style="text-transform: none;">This required:</span> 
						- Definitions of <span style="text-transform: none; color: #000000"> cyclotomic fields</span>   and  <span style="text-transform: none; color: #000000"> cyclotomic extensions</span>.
						- Definitions of <span style="text-transform: none; color: #000000">norms</span>, <span style="text-transform: none; color: #000000">trace</span> and <span style="text-transform: none; color: #000000">discriminant</span> for number fields.
						---
						### <span style="text-transform: none;">This required:</span> 
						- Definitions of <span style="text-transform: none; color: #000000"> cyclotomic fields</span>   and  <span style="text-transform: none; color: #000000"> cyclotomic extensions</span>.
						- Definitions of <span style="text-transform: none; color: #000000">norms</span>, <span style="text-transform: none; color: #000000">trace</span> and <span style="text-transform: none; color: #000000">discriminant</span> for number fields.
						- Computing the discriminant and <span style="text-transform: none; color: #000000">ring of integers</span> for $p$-power cyclotomic fields.
						---
						### <span style="text-transform: none;">This required:</span> 
						- Specific results about units in these cyclotomic fields.  <span style="text-transform: none; color: #000000"> For example</span>, that for $p \ne 2$ a prime, every unit $u \in \Z[\zeta_p]^\times$ can be written as $u=x \zeta_p^n$ for some $n \in \Z$ and $x \in \Z[\zeta_p]^\times$ such that $x \in \mathbb{R}$.
						---
						### <span style="text-transform: none;">This required </span> 
						- Dealing with lots of coercions issues. For example, for $R$ a ring and $K$ is field of fractions, we tend to think of $u \in R^\times$ as an element of $R^\times, R$ and $F$ all at once.
						- In Lean we need to explicitly say things like:
						<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" >
						lemma coe_coe_inv (u : Rˣ) : ((u : R) : K)⁻¹ = (((u⁻¹ : Rˣ) : R) : K)
						---
						### <span style="text-transform: none;">This required: </span> 
						- The proof of <span style="text-transform: none; color: #000000">FLT </span> for $n=3$ which was done independently by one of us (RVdV).
						- Its separate since at some point in the proof you need to check that four $p$-th roots of unity are distinct. Its also separate in full FLT proof.
						</code></pre>
					</textarea>	
				</section>

				
				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">Case II </span> 
						- This is the tricky one
						---
						### <span style="text-transform: none;">Case II </span>
						- This is the tricky one
						- The key result that you eventually need is <span style="text-transform: none; color: #000000">Kummer's Lemma</span>:
						---
						<div class="theorem">
							<strong>Kummer's Lemma</strong>: 
							Let $p$ be an odd regular prime and let $\zeta$ be a primitive $p$-th root of unity and $K = \mathbb{Q}(\zeta)$. 
							If $u \in \mathcal{O}_K^\times$ is a unit such that $$u \equiv n \bmod p$$ for some integer $n$, then there exists $v \in \mathcal{O}_K^\times$ 
							such that $u = v^p$.
							</div>
					</textarea>	
				</section>

								
				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">Case II: reduction </span> 
						- The idea is to assume you have a solution in this case, and wlog that $p \mid z$, so $z=p^k z_0$.
						---
						### <span style="text-transform: none;">Case II: reduction </span>
						- The idea is to assume you have a solution in this case, and wlog that $p \mid z$, so $z=p^k z_0$.
						- Then you consider the more gerenal equation in $\mathcal{O}_K$:  $$x^p+y^p=\varepsilon(\zeta-1)^{pm}z_0^p$$ with $\varepsilon$ a unit and $m$ ∈ ℕ+. Then show that this has no solutions.
						---
						### <span style="text-transform: none;">Case II: reduction </span>
						- The proof is a descent argument were you assume you have a solution to $$x^p+y^p=\varepsilon(\zeta-1)^{pm}z_0^p$$ and then get a solution for $m-1$.
						---
						### <span style="text-transform: none;">Case II: reduction </span>
						- The proof is a descent argument were you assume you have a solution to $$x^p+y^p=\varepsilon(\zeta-1)^{pm}z_0^p$$ and then get a solution for $m-1$.
						- In doing these simple mainpulations you end up needing Kummer's lemma to rearrange things to give this "smaller" solution.
					</textarea>	
				</section>




				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">Modern proof of Kummer's Lemma </span> 
						<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch"  >
							theorem Kummer (u : (𝓞 K)ˣ) (hcong : ∃ n : ℤ, (p : 𝓞 K) ∣ (u - n : 𝓞 K)) :
								∃ v, u = v ^ (p : ℕ)
						</code></pre>
						- Note  $K(u^{1/p})/K$ is a Kummer, hence abelian, extension. 
					</textarea>	
				</section>

				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">Modern proof of Kummer's Lemma </span> 
						<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch"  >
							theorem Kummer (u : (𝓞 K)ˣ) (hcong : ∃ n : ℤ, (p : 𝓞 K) ∣ (u - n : 𝓞 K)) :
								∃ v, u = v ^ (p : ℕ)
					</code></pre>

						- Note $K(u^{1/p})/K$ is a Kummer, hence abelian, extension. If its degree was $p$, then:
						- Show $K(u^{1/p})/K$ is everywhere unramified, so contained in the Hilbert class field of $K$, call it $L$.
					</textarea>	
				</section>
				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">Modern proof of Kummer's Lemma </span> 
						<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch"  >
							theorem Kummer (u : (𝓞 K)ˣ) (hcong : ∃ n : ℤ, (p : 𝓞 K) ∣ (u - n : 𝓞 K)) :
								∃ v, u = v ^ (p : ℕ)
					</code></pre>
						- Show $K(u^{1/p})/K$ is everywhere unramified, so contained in the Hilbert class field of $K$, call it $L$.	
						- So we'd have $p \mid [L : K]$, but this is the class number and $p$ is regular!
					</textarea>	
				</section>
				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">Modern proof of Kummer's Lemma </span> 
						<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch"  >
							theorem Kummer (u : (𝓞 K)ˣ)(hcong : ∃ n : ℤ, (p : 𝓞 K) ∣ (u - n : 𝓞 K)) :
								∃ v, u = v ^ (p : ℕ)
					</code></pre>
						- So we'd have $p \mid [L : K]$, but this is the class number and $p$ is regular!	
						- So we must have $K(u^{1/p}) = K$ and so $u = v^p$ for some $v \in \mathcal{O}_K^\times$.
					</textarea>	
				</section>

				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
					- Unfortunately, we can't yet formalise this proof as we dont have <span style="text-transform: none; color: #000000">CFT</span> in mathlib. So can't use "<span style="text-transform: none; color: #000000">Hilbert class field</span>".
					---
					- Unfortunately, we can't yet formalise this proof as we dont have <span style="text-transform: none; color: #000000">CFT</span> in mathlib. So can't use "<span style="text-transform: none; color: #000000">Hilbert class field</span>".
					- Instead we went for a proof closer to Kummer's original proof, which uses <span style="text-transform: none; color: #000000">Hilbert 90, 92</span> and  <span style="text-transform: none; color: #000000">94</span>!
					---
					### <span style="text-transform: none;">Hilbert 94 </span> 
					- This is historically one of the first CFT results, it says: 
					<div class="definition">
						<strong>Hilbert 94</strong>: 
						Let $L/K$ is be an unramified cyclic finite extension of number fields of odd prime degree, then there exists some non-principal ideal in $\mathcal{O}_K$ that becomes principal in $\mathcal{O}_L$ and 
						thus $[L:K]$ divides the class number of $K$.
					</div>	
					---
					### <span style="text-transform: none;">Hilbert 94 </span> 
					- Which is Lean looks like:
						<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-4|5-6|8-12|13" >
							theorem exists_not_isPrincipal_and_isPrincipal_map (K L : Type*)
								[Field K] [Field L] [NumberField K] [NumberField L] [Algebra K L]
								[FiniteDimensional K L] [IsGalois K L] [IsUnramified (𝓞 K) (𝓞 L)] [h : IsCyclic (L ≃ₐ[K] L)]                
								(hKL : Nat.Prime (finrank K L)) (hKL' : finrank K L ≠ 2) :
								∃ I : Ideal (𝓞 K), ¬I.IsPrincipal ∧ 
									(I.map (algebraMap (𝓞 K) (𝓞 L))).IsPrincipal := by...
							
							theorem dvd_card_classGroup_of_isUnramified_isCyclic (K L : Type*)
								[Field K] [Field L] [NumberField K] [NumberField L] [Algebra K L]
								[FiniteDimensional K L] [IsGalois K L] [IsUnramified (𝓞 K) (𝓞 L)] 
								[IsCyclic (L ≃ₐ[K] L)] (hKL : Nat.Prime (finrank K L))
								(hKL' : finrank K L ≠ 2) :
								finrank K L ∣ Fintype.card (ClassGroup (𝓞 K)) := by ... 
						</code></pre>
					---
					### <span style="text-transform: none;">Hilbert 94 </span> 
					- Hilbert 94 and some ramification theory is enough to prove Kummer's Lemma.
					---
					### <span style="text-transform: none;">Hilbert 94+ implies Kummer </span> 
					- Let $u \in \mathcal{O}_K^\times$ and $n \in \Z$ such that $u \equiv n \bmod p$. 
					- <span style="text-transform: none; color: #000000">Claim</span>: If $w \in \mathcal{O}_K^\times$ is a unit such that $(\zeta -1)^p \mid w-1$ then there exists some $v \in K$ such that $v^p=w$.
					---
					### <span style="text-transform: none;">Hilbert 94+ implies Kummer </span>
					- <span style="text-transform: none; color: #000000">Claim</span>: If $w \in \mathcal{O}_K^\times$ is a unit such that $(\zeta -1)^p \mid w-1$ then there exists some $v \in K$ such that $v^p=w$.
					- Idea is to show that if this claim didn't hold then:
					<span class="fragment fade-out" data-fragment-index="1" style="display: inline;"> $K(w^{1/p})/K$ is unramified and cyclic of degree $p$.</span><span class="fragment fade-in" data-fragment-index="1" style="display: inline; color: #000000" > $p$ divides the class number of $K$, which we know can't happen. </span>

					---
					### <span style="text-transform: none;">Ramification </span> 
					- This required us to develop a big chuck of ramification theory from scratch. Such as:
					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" >
						/-- The different ideal of an extension of integral domains `B/A` is the inverse of the dual of `A`
						as an ideal of `B`. -/
						def differentIdeal [NoZeroSMulDivisors A B] : Ideal B := -- 1/A*, where A* is the trace dual of A
						(1 / Submodule.traceDual A (FractionRing A) 1 : Submodule B (FractionRing B)).comap
							(Algebra.linearMap B (FractionRing B)) --this other stuff essentially makes it an ideal in B.
						</code></pre>
					---
					### <span style="text-transform: none;">Ramification </span> 
					- if you ramifiy then you divide the different ideal:
					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" >
						lemma pow_sub_one_dvd_differentIdeal 
						[IsDedekindDomain A] [NoZeroSMulDivisors A B] [Module.Finite A B]
						[Algebra.IsSeparable (FractionRing A) (FractionRing B)]
						{p : Ideal A} [p.IsMaximal] (P : Ideal B) (e : ℕ) (hp : p ≠ ⊥)
						(hP : P ^ e ∣ p.map (algebraMap A B)) : P ^ (e - 1) ∣ differentIdeal A B := by
						</code></pre>
					---
					### <span style="text-transform: none;">Ramification </span> 
					- If $K = F(\alpha)$ and min. pol. of $\alpha$ is separable modulo a prime ideal $\mathfrak{p}_F$, then  $\mathfrak{p}_F$ is unramified in $\mathcal{O}_K$.
					<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" >
						lemma isUnramifiedAt_of_Separable_minpoly [Algebra.IsSeparable K L]
						(p : Ideal R) [hp : p.IsPrime] (hpbot : p ≠ ⊥) (x : L) (hx : IsIntegral R x)
						(hx' : Algebra.adjoin K {x} = ⊤)
						(h : Polynomial.Separable ((minpoly R x).map (Ideal.Quotient.mk p))) :
							IsUnramifiedAt S p := by
						</code></pre>
					</textarea>	
				</section>


				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">Proving Hilbert 94 </span> 
						- We've reduced our problem to proving Hilbert 94. This is where we need <span style="text-transform: none; color: #000000">Hilbert 92</span>.
						---
						### <span style="text-transform: none;">Proving Hilbert 94 </span> 
						- We've reduced our problem to proving Hilbert 94. This is where we need <span style="text-transform: none; color: #000000">Hilbert 92</span>.
						- This is the most technical part of the proof.
					</textarea>	
				</section>

				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						<div class="definition">
							<strong>Hilbert 92</strong>: 
							Let $K/k$ be a cyclic extension of number fields of odd prime degree and let $\sigma$ be a generator of the Galois group. 
							Then there exists a unit $u \in \mathcal{O}_K^\times$ such that $\mathrm{Norm}_{K/k}(u)=1$ and for all $\varepsilon \in \mathcal{O}_K^\times$ we have $u \ne \varepsilon/\sigma(\varepsilon)$.
						</div>	
						---
						- This is saying that for such a $K/k$, $$H^1(\mathrm{Gal}(K/k), \mathcal{O}_K^\times) \ne 0.$$
						---
						- There exists a unit $u \in \mathcal{O}_K^\times$ with norm $1$ such that $u \ne \varepsilon/\sigma(\varepsilon)$ for $\varepsilon \in \mathcal{O}_K^\times$.
						- By Hilbert 90 we know $u = \beta / \sigma(\beta)$ for some $\beta$ (which now can't be a unit). The ideal $(\beta) \cap \mathcal{O}_k$ is then a non-pricipal ideal that becomes principal in $\mathcal{O}_K$.
						---
						- Proving Hilbert 92 is tricky. We didn't really have enough group cohomology to do this. But Swinnerton-Dyer says this wouldn't help much anyways.
						- Idea is to construct a  <span style="text-transform: none; color: #000000">fundamental system of units</span>
						---
						### <span style="text-transform: none;">Fundamental system of units </span> 
						- Let $r$ be $\mathrm{rk}_{\mathbb{Z}}(\mathcal{O}_k^\times)$. 
						---
						### <span style="text-transform: none;">Fundamental system of units </span> 
						- Let $r$ be $\mathrm{rk}_{\mathbb{Z}}(\mathcal{O}_k^\times)$. 
						- Let $U' = \mathcal{O}_K^\times / \mathcal{O}_k^\times$
						---
						### <span style="text-transform: none;">Fundamental system of units </span> 
						- Let $r$ be $\mathrm{rk}_{\mathbb{Z}}(\mathcal{O}_k^\times)$, and $U' = \mathcal{O}_K^\times / \mathcal{O}_k^\times$
						- Let $U  := U'/U'_{tors}$
						---
						### <span style="text-transform: none;">Fundamental system of units </span> 
						- Let $r$ be $\mathrm{rk}_{\mathbb{Z}}(\mathcal{O}_k^\times)$,  $U' = \mathcal{O}_K^\times / \mathcal{O}_k^\times$.
						- Let $U  := U'/U'_{tors}$
						- A <span style="text-transform: none; color: #000000">fundamental system of units</span>  is a choice of $r+1$ elements $\{h_i\}$ of $U$ such that
						$$U / \langle h_i\rangle_{\mathbb{Z}[Gal(K/k)]}$$
						is finite with minimal index.
						---
						- The key thing is that if you have such a set of units you get: if $a_0,\dots,a_{s-1}$ be integers not all divisible by $p$ and $\{h_i\}$ a fundamental system units, then
						$$
						\prod_{i=0}^{r} h_i^{a_i} \neq u/\sigma(u)
						$$
						for any $u \in U$.
						---
						- So the problem reduces to showing such a system of units exits (which is <span style="text-transform: none; color: #000000">Hilbert 91</span>).
						---
						- So the problem reduces to showing such a system of units exits (which is <span style="text-transform: none; color: #000000">Hilbert 91</span>).
						- Its just a lot of of playing with units and norms. Which is doable in mathlib.
						---
						<pre data-id="code-animation"><code data-trim  data-noescape="" class="language-lean hljs" class="stretch" data-line-numbers="1-3|5-7|9-10|12-14|16-17|19-22|23-25" >
							structure systemOfUnits (G : Type*) [AddCommGroup G] (s : ℕ) where
								units : Fin s → G  --A choice of s elements of G
								linearIndependent : LinearIndependent A units

							abbrev systemOfUnits.IsMaximal {s : ℕ} {p : ℕ+} {G : Type*} [AddCommGroup G]
								[Module A G] (sys : systemOfUnits (G := G) p s) :=
								Fintype (G ⧸ Submodule.span A (Set.range sys.units))	
							
							def systemOfUnits.IsFundamental [Module A G] (h : systemOfUnits p G s) :=
								∃ _ : h.IsMaximal, ∀ (S : systemOfUnits p G s) (_ : S.IsMaximal), h.index ≤ S.index	

							lemma corollary [Module A G] (S : systemOfUnits p G s) (hs : S.IsFundamental)
								(a : Fin s → ℤ) (ha : ∃ i , ¬ (p : ℤ) ∣ a i) : --note the additive notation.
								∀ g : G, (1 - zeta p) • g ≠ ∑ i, a i • S.units i := by ... -- the action of zeta p coincides with sigma	
							
							lemma Hilbert91 :
								∃ S : systemOfUnits p G (NumberField.Units.rank k + 1), S.IsFundamental := by ...	
							
							lemma Hilbert92 [Algebra k K] [IsGalois k K] [NumberField k] [NumberField K]
								(hKL : Nat.Prime (finrank k K)) (hpodd : finrank k K ≠ 2)
								(σ : K ≃ₐ[k] K) (hσ : ∀ x, x ∈ Subgroup.zpowers σ) :
								∃ η : (𝓞 K)ˣ, Algebra.norm k (η : K) = 1 ∧ ∀ ε : (𝓞 K)ˣ, (η : K) ≠ ε / (σ ε : K) :=
							  haveI := IsUnramifiedAtInfinitePlaces_of_odd_finrank (hKL.odd_of_ne_two hpodd)
							  letI : IsCyclic (K ≃ₐ[k] K) := ⟨σ, hσ⟩
							  almostHilbert92 ⟨finrank k K, finrank_pos⟩ hKL rfl σ hσ hpodd	
							</code></pre>
					</textarea>	
				</section>

			
				<section  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<div class="mermaid">
						graph TD;
							A["ℤ&#91;&#950;<sub>p</sub>&#93;- Modules"] --> B["<b>Hilbert 91</b>"];
							B --> C["<b>Hilbert 92</b>"];
							C --> D["<b>Hilbert 94</b>"];
							D --> E["<b>Kummer's Lemma</b>"];
							F["<b>Ramification of infinite places</b>"] --> C;
							G["<b>Different Ideal & Ramification</b>"] --> E;
							H["<b>Unramified Extensions</b>"] --> D;
							I["<b>Kummer Extensions</b>"] --> E;
							E --> J["<b>FLT for regular primes</b>"];
					</div>
				</section>

				<section data-markdown data-auto-animate data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<textarea data-template>
						### <span style="text-transform: none;">Regular primes </span> 
						- We've shown FLT for regular primes!
						---
						### <span style="text-transform: none;">Regular primes </span> 
						- We've shown FLT for regular primes!
						- Ok, what primes does Lean know are regular?
						---
						### <span style="text-transform: none;">Regular primes </span> 
						- We've shown FLT for regular primes!
						- Ok, what primes does Lean know are regular?
						- $p=2,3,5$ are the only ones we have!
						---
						### <span style="text-transform: none;">Future work </span> 
						- Use the Bernoulli description of regular primes to show lots more primes are regular.
						

						---
						### <span style="text-transform: none;">Future work </span> 
						- Use the Bernoulli description of regular primes to show lots more primes are regular.
						- Recall this says: An odd prime $p$ is <span style="text-transform: none; color: #000000">regular</span> if and only if $p$ does not divide the numerator of the <span style="text-transform: none; color: #000000">Bernoulli number</span> $B_n$ for $n = 2, 4, \ldots, p - 3$.
						---
						### <span style="text-transform: none;">Future work </span> 
						- Use the Bernoulli description of regular primes to show lots more primes are regular.
						- Recall this says: An odd prime $p$ is <span style="text-transform: none; color: #000000">regular</span> if and only if $p$ does not divide the numerator of the <span style="text-transform: none; color: #000000">Bernoulli number</span> $B_n$ for $n = 2, 4, \ldots, p - 3$.
						- This requires things like the analytic class number formula, which <span style="text-transform: none; color: #000000">Xavier Roblot</span> is working on.
						---
						
					</textarea>	
				</section>

				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<h4>Algebra and Number theory in mathlib</h4>
					<p>I really have missed out lots of things, for example:</p>
					<ul>
						<li>Category theory</li>
						<li>Homological algebra</li>
						<li>Lie Algebras</li>
						<li>Modular forms</li>	
						<li>Elliptic curves</li>
						<li>Condensed maths</li>
						<li>Riemann zeta function, $L$-series</li>
						<li>Quadratic reciprocity, Bernoulli numbers, Pell's equation</li>
					</ul>
				</section>	
				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<h4>Algebra and Number theory in mathlib</h4>
					<p>We are also still missing lots of things! For example, for full FLT, we need (among other things):</p>
					<ul>
						<li>More ring theory: Gorenstein rings</li>
						<li>More modular form theory: Hecke algebras*</li>
						<li>Tate curves</li>
						<li>Chebotarev's density theorem*</li>
						<li>Local and global class field theory*</li>
						<li> Results about finite flat group schemes</li>
						<li>Results about Galois representations</li>
					</ul>
					<hr/>
  					<div style="text-align: left; font-size: 0.5em">* means I know some people are thinking about this, ask on Zulip if interested.</div>
					
				</section>

				<section data-auto-animate  data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
					<h2>Thank you!</h2>
					
				</section>

				  
				  

		

		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/zoom/zoom.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/search/search.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/highlight/lean.min.js"></script>
  		<script src="plugin/highlight/lean-goal.js"></script>
		<script src="plugin/math/math.js"></script>
		<script>
			// Also available as an ES module, see:
			// https://revealjs.com/initialization/
			Reveal.initialize({
				controls: true,
				progress: true,
				center: true,
				hash: true,
				margin: 0,
		
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight, RevealMath.KaTeX ],
		
				// Add the markdown option with the preprocess function
				markdown: {
					preprocess: function(markdown) {
						// Replace all occurrences of [[...]] with the desired span
						console.log("Preprocess function is called");
						return markdown.replace(/\[\[(.*?)\]\]/g, function(match, p1) {
							return '<span style="text-transform: none; color: #000000">' + p1 + '</span>';
						});
					}
				}
			});
		</script>
		
	</body>
</html>
